webpackJsonp([6],{83:function(e,o,r){e.exports=r.p+"/assets/fonts/spinner.svg?30bb05aafe5e7eaac538eee863c5490c"},137:function(e,o,r){o=e.exports=r(4)(),o.push([e.id,".signin-page .app-header-fixed{padding-top:0}.signin-form{width:420px;max-width:96%;margin-left:auto;margin-right:auto;padding-top:10vh}.signin-form .login-checking{position:absolute;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);color:#fff;border-radius:3px;z-index:3;display:flex;justify-content:center;align-items:center}.signin-form .login-checking .icons{font-size:3rem}.signin-form .login-checking h4{font-weight:300;animation:pulse .8s linear infinite}.signin-form h2{font-weight:300;text-transform:uppercase}.signin-form h2 a{color:inherit}.signin-form h2 a:hover{color:#7266ba}.signin-form .form-box{box-shadow:0 3px 10px rgba(0,0,0,.06);margin:3rem 0 0;padding:2rem 2rem 3rem;background-color:#fff;border-radius:4px;position:relative}.signin-form .form-box .btn{margin-top:2rem}.signin-form .login-message{padding:.8rem 1.5rem;margin-bottom:1.5rem;color:#fff;border-radius:2px;font-weight:300}.signin-form .login-message.error{background-color:#f05050}.signin-form .login-message.success{background-color:#7266ba}.signin-form .login-message.ng-enter,.signin-form .login-message.ng-leave{transition:all .2s ease-in-out}.signin-form .login-message.ng-enter,.signin-form .login-message.ng-leave.ng-leave-active{-webkit-transform:scaleY(0);transform:scaleY(0);opacity:0}.signin-form .login-message.ng-enter.ng-enter-active,.signin-form .login-message.ng-leave{-webkit-transform:scaleY(1);transform:scaleY(1);opacity:1}",""])},152:function(e,o,r){var t=r(137);"string"==typeof t&&(t=[[e.id,t,""]]);r(5)(t,{});t.locals&&(e.exports=t.locals)},172:function(e,o,r){e.exports='<div class=signin-form> <div class=wrapper> <div class=text-center> <h2><a ui-sref=root.layout.home>Todo Movies App</a></h2> <small>欢迎体验 Todo Movies App， 测试登录账号为: user: todomovieapp pwd: 88888888</small> </div> <div class=form-box> <div ng-if=form.hasUserLoginState class="login-checking text-white"> <div class="loading-text text-center" ng-if=!form.userInfo.user> <img src='+r(83)+' width=48 height=48> <p>Checking User...</p> </div> <div class="loading-text text-center" ng-if=form.userInfo.user> <i class="icons icon-user"></i> <h4>{{form.userInfo.user.username}}</h4> </div> </div> <form class=login-form name=form.loginForm ng-submit=form.login(form.account) autocomplete=off novalidate> <div ng-if=form.loginError class="login-message {{form.loginError.type}}"> <p>{{form.loginError.text}}</p> </div> <div class=form-group> <label for=username>用户名</label> <input id=username type=text class=form-control placeholder=username ng-model=form.account.username required> </div> <div class=form-group> <label for=password>密码</label> <input id=password type=password class=form-control placeholder=password ng-model=form.account.password required> </div> <button type=submit class="btn btn-primary btn-block btn-round" ng-disabled="form.loginForm.$invalid || form.isAjaxRequest">Submit <i class=spinner ng-if=form.isAjaxRequest> <img src='+r(83)+" width=18 height=18></i> </button> </form> </div> </div> </div>"},179:function(e,o){e.exports="<login-form has-user-login-state=vm.hasUserLoginState user-info=vm.userInfo login-error=vm.loginError redirect-uri=vm.redirectUri></login-form>"},205:function(e,o,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(o,"__esModule",{value:!0}),r(152);var t=r(172),i=_interopRequireDefault(t),n=r(206),s=_interopRequireDefault(n),a={bindings:{hasUserLoginState:"<",userInfo:"<",loginError:"<",redirectUri:"<"},template:i["default"],controller:s["default"],controllerAs:"form"};o["default"]=angular.module("app.components.loginForm",[]).component("loginForm",a)},206:function(e,o,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(o,"__esModule",{value:!0});var t=r(3),i=_interopRequireDefault(t),n=r(1),s=_interopRequireDefault(n),a=r(2),l=_interopRequireDefault(a),u=function(){function LoginFormcontroller(e,o,r,t){"ngInject";(0,s["default"])(this,LoginFormcontroller),(0,i["default"])(this,{$state:e,$rootScope:o,$timeout:r,AccountApi:t}),this.__clearMsg()}return LoginFormcontroller.$inject=["$state","$rootScope","$timeout","AccountApi"],(0,l["default"])(LoginFormcontroller,[{key:"login",value:function login(e){var o=this;this.loginForm.$invalid||(this.loginError=null,this.isAjaxRequest=!0,this.AccountApi.$login(e).then(function(){o.__setErrorMessage("success","登录成功，正在重定向到登录前的页面!"),o.$timeout(function(){if(o.redirectUri)window.location.href=decodeURIComponent(o.redirectUri);else{var e=o.$state.href(o.$rootScope.prev.state,o.$rootScope.prev.params);o.$rootScope.prev=null,window.location.href=e}},2e3)},function(e){return o.__error(e)}))}},{key:"__error",value:function __error(e){this.__setErrorMessage("error",e.data.status_message),this.isAjaxRequest=!1}},{key:"__setErrorMessage",value:function __setErrorMessage(e,o){this.loginError={type:e,text:o},this.__clearMsg()}},{key:"__clearMsg",value:function __clearMsg(){var e=this;this.$timeout(function(){e.loginError=null},3e3)}}]),LoginFormcontroller}();o["default"]=u},237:function(e,o,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(o,"__esModule",{value:!0});var t=r(205),i=_interopRequireDefault(t),n=r(238),s=_interopRequireDefault(n),a=angular.module("app.pages.login",[i["default"].name]).controller(s["default"].name,s["default"]);o["default"]=a.name},238:function(e,o,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(o,"__esModule",{value:!0});var t=r(3),i=_interopRequireDefault(t),n=r(1),s=_interopRequireDefault(n),a=r(2),l=_interopRequireDefault(a),u=function(){function LoginController(e,o,r,t){"ngInject";var n=this;(0,s["default"])(this,LoginController),(0,i["default"])(this,{$state:e,$timeout:o,$rootScope:r,AccountApi:t});var a=this.$state.params.action;this.redirectUri=this.$state.params.redirect||null,"logout"===a?(this.hasUserLoginState=!1,this.AccountApi.$logout().then(function(){n.$rootScope.userIsLoggedIn=!1,n.$rootScope.user=null,n.loginError={type:"success",text:"你已经成功退出登录!"}})):this.$checkLoggedInStatus()}return LoginController.$inject=["$state","$timeout","$rootScope","AccountApi"],(0,l["default"])(LoginController,[{key:"$checkLoggedInStatus",value:function $checkLoggedInStatus(){var e=this;this.hasUserLoginState=!0;var o=this.AccountApi.$isLoggedIn();o?!function(){var o=e.AccountApi.$getUserInfo();e.$timeout(function(){e.userInfo=o},1e3),e.$timeout(function(){e.$state.go(e.$rootScope.prev.state,e.$rootScope.prev.params),e.$rootScope.prev=null},2e3)}():this.$timeout(function(){e.hasUserLoginState=!1},1e3)}}]),LoginController}();o["default"]=u}});